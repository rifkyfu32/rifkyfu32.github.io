<!DOCTYPE html>
<html lang="en">

<head>
    <title>Optimasi SSD &amp; Konfigurasi Web Server di Ubuntu 18.04</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<meta itemprop="name" content="Optimasi SSD &amp; Konfigurasi Web Server di Ubuntu 18.04">
<meta itemprop="description" content="Catatan pribadi :
 SSD untuk Ubuntu 18.04.2 LTS, full hanya satu partisi root / HDD untuk menyimpan data  fstab  buka fstab  sudo gedit /etc/fstab   matikan update tanggal file noatime,nodiratime :  UUID=d8c6a126-8cbe-4f72-8ab2-2e9b09b28a25 / ext4 noatime,nodiratime,errors=remount-ro 0 1   pindah file log ke RAM :  tmpfs /tmp tmpfs defaults,noatime,mode=1777 0 0 tmpfs /var/spool tmpfs defaults,noatime,mode=1777 0 0 tmpfs /var/log tmpfs defaults,noatime,mode=0755 0 0  Scheduler I/O : Untuk SSD direkomendasikan oleh Wiki Ubuntu memakai I/O deadline.">


<meta itemprop="datePublished" content="2019-08-04T23:46:41&#43;07:00" />
<meta itemprop="dateModified" content="2019-08-04T23:46:41&#43;07:00" />
<meta itemprop="wordCount" content="442">



<meta itemprop="keywords" content="tag," />


<meta property="og:title" content="Optimasi SSD &amp; Konfigurasi Web Server di Ubuntu 18.04" />
<meta property="og:description" content="Catatan pribadi :
 SSD untuk Ubuntu 18.04.2 LTS, full hanya satu partisi root / HDD untuk menyimpan data  fstab  buka fstab  sudo gedit /etc/fstab   matikan update tanggal file noatime,nodiratime :  UUID=d8c6a126-8cbe-4f72-8ab2-2e9b09b28a25 / ext4 noatime,nodiratime,errors=remount-ro 0 1   pindah file log ke RAM :  tmpfs /tmp tmpfs defaults,noatime,mode=1777 0 0 tmpfs /var/spool tmpfs defaults,noatime,mode=1777 0 0 tmpfs /var/log tmpfs defaults,noatime,mode=0755 0 0  Scheduler I/O : Untuk SSD direkomendasikan oleh Wiki Ubuntu memakai I/O deadline." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rifkyfu32.github.io/blog/optimasi-ssd-ubuntu-lts/" />



<meta property="article:published_time" content="2019-08-04T23:46:41&#43;07:00"/>

<meta property="article:modified_time" content="2019-08-04T23:46:41&#43;07:00"/>











<meta content='summary_large_image' name='twitter:card' />
<meta content='@Fuu_ady' name='twitter:site' />
<meta content='@Fuu_ady' name='twitter:creator' />
<meta property='og:image' content='https://rifkyfu32.github.io'
/>
<meta content='id_ID' property='og:locale' />
<meta content='ms_MY' property='og:locale:alternate' />
<meta content='en_US' property='og:locale:alternate' />

<meta content='rifky.fuady2' property='fb:profile_id' />

<meta property="article:author" content="https://web.facebook.com/rifky.fuady2" />

<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/img/favicon.png" />

<link rel="stylesheet" href="/css/bootstrap.min.css" />
<link rel="stylesheet" href="/css/prism.css" />
<link rel="stylesheet" href="/css/style.css" />



<link href='https://fonts.googleapis.com/css?family=Merriweather:400,700' rel='stylesheet' type='text/css'> 

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145189876-1', 'auto');
ga('send', 'pageview');
</script>


</head>

<body class="bg-light">

    <header>
    <div class="container">
        <div class="row">
            <div class="col text-center mt-5">
                <h1>
                    <a href="https://rifkyfu32.github.io">
                        <img class="mw-100" src="/img/logo.png" height="100" alt="logo" />
                    </a>
                </h1>

                <ul class="nav justify-content-center">
                    <li class="nav-item">
                        <a class="nav-link" href="/about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/portofolio">Portofolio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.instagram.com/fuadyrifky" target="blank">Instagram</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/rifkyfu32" target="blank">Github</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</header>


    <div class="container mt-5 mb-5">
        <div class="row align-items-center justify-content-center">
            <div class="col-lg-8 col-12">
                <div class="card rounded-0 post-outer">
                    <div class="card-body p-md-5">
                        <div class="post-content">
                            <div class="post-header mb-3">
                                <h2 class="post-title">Optimasi SSD & Konfigurasi Web Server di Ubuntu 18.04</h2>
                                <hr>
                                <time class="text-secondary small" title="2019-08-04 23:46:41 &#43;0700 WIB">4 Aug 2019</time>
                            </div>
                            <div class="post-body">
                                

<p><strong>Catatan <code>pribadi</code> :</strong></p>

<ul>
<li><code>SSD</code> untuk <code>Ubuntu 18.04.2 LTS</code>, full hanya satu partisi <code>root</code> /</li>
<li><code>HDD</code> untuk <code>menyimpan</code> data</li>
</ul>

<h1 id="fstab">fstab</h1>

<ul>
<li>buka <code>fstab</code></li>
</ul>

<pre><code class="language-bash">sudo gedit /etc/fstab 
</code></pre>

<ul>
<li>matikan update tanggal file <code>noatime,nodiratime</code> :</li>
</ul>

<pre><code class="language-bash">UUID=d8c6a126-8cbe-4f72-8ab2-2e9b09b28a25 / ext4 noatime,nodiratime,errors=remount-ro 0 1
</code></pre>

<ul>
<li>pindah file <code>log</code> ke <code>RAM</code> :</li>
</ul>

<pre><code class="language-bash">tmpfs /tmp tmpfs defaults,noatime,mode=1777 0 0
tmpfs /var/spool tmpfs defaults,noatime,mode=1777 0 0
tmpfs /var/log tmpfs defaults,noatime,mode=0755 0 0
</code></pre>

<h1 id="scheduler-i-o">Scheduler I/O :</h1>

<p>Untuk SSD direkomendasikan oleh <a href="https://wiki.ubuntu.com/Kernel/Reference/IOSchedulers">Wiki Ubuntu</a> memakai I/O <code>deadline</code>.</p>

<ul>
<li>bikin file <code>60-ssd-scheduler.rules</code></li>
</ul>

<pre><code class="language-bash">sudo touch /etc/udev/rules.d/60-ssd-scheduler.rules
</code></pre>

<ul>
<li>buka file <code>60-ssd-scheduler.rules</code></li>
</ul>

<pre><code class="language-bash">sudo gedit /etc/udev/rules.d/60-ssd-scheduler.rules
</code></pre>

<ul>
<li>tambahkan</li>
</ul>

<pre><code class="language-bash">ACTION==&quot;add|change&quot;, KERNEL==&quot;sd[a-z]&quot;, ATTR{queue/rotational}==&quot;0&quot;, ATTR{queue/scheduler}=&quot;deadline&quot;
</code></pre>

<ul>
<li>cek konfigurasi</li>
</ul>

<pre><code class="language-bash">for f in /sys/block/sd?/queue/scheduler; do printf &quot;$f is &quot;; cat $f; done
</code></pre>

<h1 id="web-server-dan-database">Web Server dan Database</h1>

<p>Tujuan penggunaan untuk develop aplikasi, untuk aplikasi web dalam membangun <code>Web Server</code> menggunakan <code>Apache</code>.</p>

<p>Karena tidak akan menyimpan aplikasi di /var/www/html tetapi di HDD menggunakan <code>Symbolic link</code>.</p>

<p>Log yang sudah dipindah di RAM (<code>fstab</code>) akan hilang ketika di restart akan terjadi error tidak bisa menjalankan <code>Apache</code> maupun <code>MySql</code>.</p>

<p>Maka dari itu memerlukan konfigurasi <strong>ekstra</strong>.</p>

<h1 id="apache2">Apache2</h1>

<ul>
<li>membuat <code>log apache</code></li>
</ul>

<pre><code class="language-bash">sudo mkdir /var/apache2/
sudo touch /var/apache2/error.log
sudo touch /var/apache2/access.log
sudo touch /var/apache2/other_vhosts_access.log
sudo chown root:adm /var/apache2
sudo chown root:adm /var/apache2/error.log
sudo chown root:adm /var/apache2/access.log
sudo chown root:adm /var/apache2/other_vhosts_access.log
sudo chmod 0750 /var/apache2
sudo chmod 0640 /var/apache2/error.log
sudo chmod 0640 /var/apache2/access.log
sudo chmod 0640 /var/apache2/other_vhosts_access.log
</code></pre>

<ul>
<li>edit envvars <code>APACHE_LOG_DIR</code></li>
</ul>

<pre><code class="language-bash">sudo gedit /etc/apache2/envvars
</code></pre>

<pre><code class="language-bash">export APACHE_LOG_DIR=/var/apache2$SUFFIX
</code></pre>

<ul>
<li>melakukan <code>Symbolic link</code></li>
</ul>

<pre><code class="language-bash">sudo ln -s /mnt/32a34605-e617-4bf9-87bf-9d7c2a44a10f/project/web/ /var/www/
</code></pre>

<ul>
<li>konfigurasi apache2.conf edit <code>LogLevel</code> dan <code>AllowOverride</code></li>
</ul>

<pre><code class="language-bash">sudo gedit /etc/apache2/apache2.conf
</code></pre>

<pre><code class="language-bash">LogLevel error
AllowOverride All
</code></pre>

<ul>
<li>aktifkan <code>a2enmod</code></li>
</ul>

<pre><code class="language-bash">sudo a2enmod rewrite
</code></pre>

<ul>
<li>arahkan <code>localhost</code> ke <code>Symbolic link</code> dan konfigurasi</li>
</ul>

<pre><code class="language-bash">sudo gedit /etc/apache2/sites-available/000-default.conf
</code></pre>

<pre><code class="language-bash">DocumentRoot /var/www/web
LogLevel error
ErrorLog /var/www/web/error.log
CustomLog /var/www/web/access.log combined
</code></pre>

<ul>
<li><code>restart</code> apache</li>
</ul>

<pre><code class="language-bash">sudo service apache2 restart
</code></pre>

<h1 id="mrcrypt">Mrcrypt</h1>

<p><a href="https://gist.github.com/rifkyfu32/65c45e00999548a7c37f61395c7bcbe6">sumber gist</a></p>

<ul>
<li><code>install ekstensi</code> mcrypt</li>
</ul>

<pre><code class="language-bash">sudo apt-get install php7.2-dev
sudo apt-get -y install libmcrypt-dev
sudo pecl install mcrypt-1.0.1
</code></pre>

<ul>
<li>tekan Enter untuk <code>autodetect</code>.</li>
<li>tambahkan ke <code>cli</code> dan <code>apache2</code> php.ini</li>
</ul>

<pre><code class="language-bash">sudo bash -c &quot;echo extension=/usr/lib/php/20170718/mcrypt.so &gt; /etc/php/7.2/cli/conf.d/mcrypt.ini&quot;
sudo bash -c &quot;echo extension=/usr/lib/php/20170718/mcrypt.so &gt; /etc/php/7.2/apache2/conf.d/mcrypt.ini&quot;
</code></pre>

<ul>
<li><code>cek</code> ekstensi terinstall</li>
</ul>

<pre><code class="language-bash">php -i | grep mcrypt
</code></pre>

<ul>
<li>restart apache</li>
</ul>

<pre><code class="language-bash">sudo service apache2 restart
</code></pre>

<h1 id="mysql">Mysql</h1>

<ul>
<li>membuat <code>log mysql</code></li>
</ul>

<pre><code class="language-bash">sudo mkdir /var/mysql/
sudo touch /var/mysql/error.log
sudo chown mysql:adm /var/mysql
sudo chown mysql:adm /var/mysql/error.log
sudo chmod 0750 /var/mysql 
sudo chmod 0640 /var/mysql/error.log
</code></pre>

<ul>
<li>mengubah log file <code>apparmor</code> mysql</li>
</ul>

<pre><code class="language-bash">sudo gedit /etc/apparmor.d/usr.sbin.mysqld
</code></pre>

<pre><code class="language-bash"># Allow log file access :
  /var/mysql.err rw,
  /var/mysql.log rw,
  /var/mysql/ r,
  /var/mysql/** rw,
</code></pre>

<ul>
<li>reload <code>apparmor</code></li>
</ul>

<pre><code class="language-bash">sudo systemctl reload apparmor
</code></pre>

<ul>
<li><code>mengarahkan</code> log dan <code>izin</code> remote koneksi</li>
</ul>

<pre><code class="language-bash">sudo gedit /etc/mysql/mysql.conf.d/mysqld.cnf
</code></pre>

<pre><code class="language-bash">log_error = /var/mysql/error.log
bind-address = 0.0.0.0
</code></pre>

<ul>
<li><code>restart</code> MySql</li>
</ul>

<pre><code class="language-bash">sudo service mysql restart
</code></pre>

<h1 id="allow-remote-dbquery">Allow remote dbquery</h1>

<ul>
<li><code>membuat</code> user untuk <code>remote</code> db</li>
</ul>

<pre><code class="language-bash">CREATE USER 'docker'@'localhost' IDENTIFIED BY 'docker';
GRANT ALL PRIVILEGES ON *.* TO 'docker'@'localhost' WITH GRANT OPTION;
CREATE USER 'docker'@'%' IDENTIFIED BY 'docker';
GRANT ALL PRIVILEGES ON *.* TO 'docker'@'%' WITH GRANT OPTION;
FLUSH PRIVILEGES;
</code></pre>

                            </div>
                            <div class="post-footer mt-5 py-4">
                                
                                 <div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'rifkyfu32-github-io';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

</script>
<noscript>Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by
    <span class="logo-disqus">Disqus</span>
</a> 
                            </div>
                        </div>
                    </div>
                </div>

                 <footer class="mt-5 mb-5">
    <div class="text-center text-secondary">

       &copy; 2020 <a href="https://rifkyfu32.github.io" class="text-secondary"> Rifky Fuady</a> &ndash; <a href="/privacy-policy" class="text-secondary"> Privacy Policy</a>

    </div>
</footer>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="/js/jquery-3.2.1.slim.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/prism.js"></script>
<script type="text/javascript" async src="/js/lazysizes.min.js"></script>





</body>

</html>