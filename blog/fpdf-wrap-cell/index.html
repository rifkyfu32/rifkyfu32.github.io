<!DOCTYPE html>
<html lang="en">

<head>
    <title>Laporan PDF cantik, Auto Wrap Content Table dengan FPDF</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<meta itemprop="name" content="Laporan PDF cantik, Auto Wrap Content Table dengan FPDF">
<meta itemprop="description" content="Pernah gak sih, pas lagi bikin laporan dengan FPDF, ternyata hasilnya tidak sesuai harapan?
Saat isi data pada suatu kolom melebihi lebar dari kolom tersebut, maka tulisannya akan kepotong alias gak keliatan. Hehe&hellip;
Kebetulan tadi sore saya sendiri mengalaminya, biar gak lupa mending catet aja di blog.
Perkenalan sedikit, FPDF adalah library PHP yang bisa kita manfaatkan untuk membuat file PDF (bikin laporan).
Bagi anda yang belum pernah menggunakan library FPDF, silahkan bermain-main dengan tutorial dasarnya terlebih dahulu.">


<meta itemprop="datePublished" content="2019-03-14T22:47:33&#43;07:00" />
<meta itemprop="dateModified" content="2019-03-14T22:47:33&#43;07:00" />
<meta itemprop="wordCount" content="489">



<meta itemprop="keywords" content="tag," />


<meta property="og:title" content="Laporan PDF cantik, Auto Wrap Content Table dengan FPDF" />
<meta property="og:description" content="Pernah gak sih, pas lagi bikin laporan dengan FPDF, ternyata hasilnya tidak sesuai harapan?
Saat isi data pada suatu kolom melebihi lebar dari kolom tersebut, maka tulisannya akan kepotong alias gak keliatan. Hehe&hellip;
Kebetulan tadi sore saya sendiri mengalaminya, biar gak lupa mending catet aja di blog.
Perkenalan sedikit, FPDF adalah library PHP yang bisa kita manfaatkan untuk membuat file PDF (bikin laporan).
Bagi anda yang belum pernah menggunakan library FPDF, silahkan bermain-main dengan tutorial dasarnya terlebih dahulu." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rifkyfu32.github.io/blog/fpdf-wrap-cell/" />



<meta property="article:published_time" content="2019-03-14T22:47:33&#43;07:00"/>

<meta property="article:modified_time" content="2019-03-14T22:47:33&#43;07:00"/>











<meta content='summary_large_image' name='twitter:card' />
<meta content='@Fuu_ady' name='twitter:site' />
<meta content='@Fuu_ady' name='twitter:creator' />
<meta property='og:image' content='https://rifkyfu32.github.io'
/>
<meta content='id_ID' property='og:locale' />
<meta content='ms_MY' property='og:locale:alternate' />
<meta content='en_US' property='og:locale:alternate' />

<meta content='rifky.fuady2' property='fb:profile_id' />

<meta property="article:author" content="https://web.facebook.com/rifky.fuady2" />


<link rel="icon" href="/img/favicon.png" />

<link rel="stylesheet" href="/css/bootstrap.min.css" />
<link rel="stylesheet" href="/css/prism.css" />
<link rel="stylesheet" href="/css/style.css" />



<link href='https://fonts.googleapis.com/css?family=Merriweather:400,700' rel='stylesheet' type='text/css'> 

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-136111907-1', 'auto');
ga('send', 'pageview');
</script>


</head>

<body class="bg-light">

    <header>
    <div class="container">
        <div class="row">
            <div class="col text-center mt-5">
                <h1>
                    <a href="https://rifkyfu32.github.io">
                        <img class="mw-100" src="/img/logo.png" height="100" alt="logo" />
                    </a>
                </h1>

                <ul class="nav justify-content-center">
                    <li class="nav-item">
                        <a class="nav-link" href="/about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/portofolio">Portofolio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.instagram.com/fuadyrifky" target="blank">Instagram</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/rifkyfu32" target="blank">Github</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</header>


    <div class="container mt-5 mb-5">
        <div class="row align-items-center justify-content-center">
            <div class="col-lg-8 col-12">
                <div class="card rounded-0 post-outer">
                    <div class="card-body p-md-5">
                        <div class="post-content">
                            <div class="post-header mb-3">
                                <h2 class="post-title">Laporan PDF cantik, Auto Wrap Content Table dengan FPDF</h2>
                                <hr>
                                <time class="text-secondary small" title="2019-03-14 22:47:33 &#43;0700 WIB">14 Mar 2019</time>
                            </div>
                            <div class="post-body">
                                

<p><strong>Pernah gak sih, pas lagi bikin laporan dengan <code>FPDF</code>, ternyata hasilnya tidak sesuai harapan?</strong></p>

<p>Saat isi data pada suatu kolom <code>melebihi</code> lebar dari kolom tersebut, maka tulisannya akan <code>kepotong</code> alias <code>gak keliatan</code>. Hehe&hellip;</p>

<p>Kebetulan tadi sore saya sendiri mengalaminya, biar gak lupa mending catet aja di blog.</p>

<p>Perkenalan sedikit, <a href="http://fpdf.org/">FPDF</a> adalah <code>library PHP</code> yang bisa kita manfaatkan untuk membuat file <code>PDF</code> <em>(bikin laporan)</em>.</p>

<p>Bagi anda yang belum pernah menggunakan library <a href="http://fpdf.org/">FPDF</a>, silahkan bermain-main dengan tutorial dasarnya terlebih dahulu.</p>

<p>Disini saya hanya akan memberikan <code>snippet code</code>, berbagi cara agar output tabel file PDF menjadi rapi nan cantik.</p>

<p>Berikut ini adalah contoh output masalah yang saya hadapi tadi sore :</p>

<p><img data-src="/img/fpdf-wrap-cell/1.png" class="lazyload" /></p>

<p>Terlihat jelas, kolom pesan terlalu panjang isinya sehingga terpotong, ini terjadi karena saya hanya menggunakan fungsi <code>$pdf-&gt;Cell</code>. Berikut saya lampirkan <code>snippet code</code>-nya :</p>

<pre><code class="language-bash">while($hasil=mysqli_fetch_array($data)){
    $pdf-&gt;SetFillColor(255,255,255);
    $pdf-&gt;Cell(1,0.8,$no++,1,0,'C',true);
    $pdf-&gt;Cell(4,0.8,$hasil['tanggal'],1,0,'L',true);
    $pdf-&gt;Cell(20,0.8,$hasil['pesan'],1,0,'L',true);
    $pdf-&gt;Cell(3,0.8,$hasil['pengirim'],1,0,'L',true);
    $pdf-&gt;Ln();
}
</code></pre>

<p>Kemudian seperti biasa, saya bertanya kepada mbah dukun terhebat saya, <strong><code>Stackoverflow</code></strong>, ketemulah diskusi <a href="https://stackoverflow.com/questions/3477372/make-text-wrap-in-a-cell-with-fpdf">disini</a>, solusinya menyarankan untuk menggunakan fungsi <code>$pdf-&gt;MultiCell</code>.</p>

<p>Gak pake lama, langsung saya coba dan hasilnya :</p>

<p><img data-src="/img/fpdf-wrap-cell/2.png" class="lazyload" /></p>

<p>Haduuuhhh kok malah jadi berantakan, berikut <code>snippet code</code>-nya :</p>

<pre><code class="language-bash">while($hasil=mysqli_fetch_array($data)){
    $pdf-&gt;SetFillColor(255,255,255);
    $pdf-&gt;Cell(1,0.8,$no++,1,0,'C',true);
    $pdf-&gt;Cell(4,0.8,$hasil['tanggal'],1,0,'L',true);
    $pdf-&gt;MultiCell(20,0.8,$hasil['pesan'],1,'L');
    $pdf-&gt;Cell(3,0.8,$hasil['pengirim'],1,0,'L',true);
    $pdf-&gt;Ln();
}
</code></pre>

<p>Tapi kalo dilihat-lihat dan agak sedikit dipikir, hhmmm&hellip; sepertinya gak bisa main <code>copy-paste</code> nih macam tugas kampus, rasanya tidak menghargai Tuhan kalo saya tidak memanfaatkan otak untuk berfikir, padahal sudah dikasih <code>gratis</code> sejak lahir, hehehe&hellip;</p>

<p>Merenung sejenak, <code>try-error-learn</code> berulang-ulang muter otak sampe semedi nongkrong di kamar mandi, dan akhirnya&hellip; taraaaa&hellip;</p>

<p><img data-src="/img/fpdf-wrap-cell/3.png" class="lazyload" /></p>

<p>Maka, benar sabda <code>Kakek Bijak</code> :</p>

<blockquote>
<h4 id="usaha-tidak-akan-pernah-mengkhianati-hasil-maka-jangan-pernah-menyerah"><code>Usaha</code> Tidak Akan Pernah <code>Mengkhianati Hasil</code>, Maka <code>Jangan Pernah Menyerah</code> !</h4>
</blockquote>

<p>berikut <code>snippet code</code> beserta penjelasan tiap barisnya :</p>

<pre><code class="language-bash">while($hasil=mysqli_fetch_array($data)){
    $cellWidth=20; //lebar sel
	$cellHeight=1; //tinggi sel satu baris normal
	
	//periksa apakah teksnya melibihi kolom?
	if($pdf-&gt;GetStringWidth($hasil['pesan']) &lt; $cellWidth){
		//jika tidak, maka tidak melakukan apa-apa
		$line=1;
	}else{
		//jika ya, maka hitung ketinggian yang dibutuhkan untuk sel akan dirapikan
		//dengan memisahkan teks agar sesuai dengan lebar sel
		//lalu hitung berapa banyak baris yang dibutuhkan agar teks pas dengan sel
		
		$textLength=strlen($hasil['pesan']);	//total panjang teks
		$errMargin=5;		//margin kesalahan lebar sel, untuk jaga-jaga
		$startChar=0;		//posisi awal karakter untuk setiap baris
		$maxChar=0;			//karakter maksimum dalam satu baris, yang akan ditambahkan nanti
		$textArray=array();	//untuk menampung data untuk setiap baris
		$tmpString=&quot;&quot;;		//untuk menampung teks untuk setiap baris (sementara)
		
		while($startChar &lt; $textLength){ //perulangan sampai akhir teks
			//perulangan sampai karakter maksimum tercapai
			while( 
			$pdf-&gt;GetStringWidth( $tmpString ) &lt; ($cellWidth-$errMargin) &amp;&amp;
			($startChar+$maxChar) &lt; $textLength ) {
				$maxChar++;
				$tmpString=substr($hasil['pesan'],$startChar,$maxChar);
			}
			//pindahkan ke baris berikutnya
			$startChar=$startChar+$maxChar;
			//kemudian tambahkan ke dalam array sehingga kita tahu berapa banyak baris yang dibutuhkan
			array_push($textArray,$tmpString);
			//reset variabel penampung
			$maxChar=0;
			$tmpString='';
			
		}
		//dapatkan jumlah baris
		$line=count($textArray);
	}
	
    //tulis selnya
    $pdf-&gt;SetFillColor(255,255,255);
	$pdf-&gt;Cell(1,($line * $cellHeight),$no++,1,0,'C',true); //sesuaikan ketinggian dengan jumlah garis
	$pdf-&gt;Cell(4,($line * $cellHeight),$hasil['tanggal'],1,0); //sesuaikan ketinggian dengan jumlah garis
	
	//memanfaatkan MultiCell sebagai ganti Cell
	//atur posisi xy untuk sel berikutnya menjadi di sebelahnya.
	//ingat posisi x dan y sebelum menulis MultiCell
	$xPos=$pdf-&gt;GetX();
	$yPos=$pdf-&gt;GetY();
	$pdf-&gt;MultiCell($cellWidth,$cellHeight,$hasil['pesan'],1);
	
	//kembalikan posisi untuk sel berikutnya di samping MultiCell 
    //dan offset x dengan lebar MultiCell
	$pdf-&gt;SetXY($xPos + $cellWidth , $yPos);
	
    $pdf-&gt;Cell(3,($line * $cellHeight),$hasil['pengirim'],1,1); //sesuaikan ketinggian dengan jumlah garis
}
</code></pre>

                            </div>
                            <div class="post-footer mt-5 py-4">
                                
                                 <div id="disqus_thread"></div>
<script type="text/javascript">
    (function () {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'rifkyfu32-github-io';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

</script>
<noscript>Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by
    <span class="logo-disqus">Disqus</span>
</a> 
                            </div>
                        </div>
                    </div>
                </div>

                 <footer class="mt-5 mb-5">
    <div class="text-center text-secondary">

       &copy; 2019 <a href="https://rifkyfu32.github.io" class="text-secondary"> Rifky Fuady</a> &ndash; <a href="/privacy-policy" class="text-secondary"> Privacy Policy</a>

    </div>
</footer>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="/js/jquery-3.2.1.slim.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/prism.js"></script>
<script type="text/javascript" async src="/js/lazysizes.min.js"></script>





</body>

</html>